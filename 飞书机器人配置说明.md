# 飞书机器人配置说明

## 🚀 功能概述

现在您的网站已经支持**双重推送**功能：
- ✅ **钉钉机器人** - 原有的推送功能
- 🆕 **飞书机器人** - 新增的推送功能

每次有新的销售线索时，系统会**同时**推送到钉钉和飞书两个平台，确保您不会错过任何客户咨询。

## ⚙️ 配置信息

### 飞书机器人配置
- **Webhook地址**: `https://open.larksuite.com/open-apis/bot/v2/hook/3900791f-0dfd-4821-8d5f-58d158487db7`
- **签名校验**: `8THJN0RgyJuprBVwkNn1ef`
- **状态**: ✅ 已配置完成

### 钉钉机器人配置
- **Access Token**: `f7cf0fd1267222a98e223611734a46cc9a705ac8ff8eb9773dcf392aa4fdc0e8`
- **状态**: ✅ 已配置完成

## 🔧 技术实现

### 推送逻辑
1. **并行推送**: 使用 `Promise.all()` 同时推送到两个平台
2. **容错处理**: 只要有一个平台推送成功，就返回成功给用户
3. **详细日志**: 记录每个平台的推送结果

### 飞书消息格式
- **消息类型**: `post` (富文本消息)
- **语言**: 中文 (`zh_cn`)
- **内容**: 包含完整的客户咨询信息

## 📱 消息内容

### 简化表单消息
- 🎯 新客户咨询标题
- 📧 邮箱地址
- 📱/🐧/✈️ 联系方式（自动识别QQ、Telegram等）
- ⚽ 感兴趣的体育项目
- 🎯 使用场景
- ⏰ 咨询时间
- 🚀 跟进提醒

### 多步骤表单消息
- 🎯 高价值客户咨询标题
- 📋 基本信息（公司、联系人、邮箱、电话）
- 💼 业务需求（体育项目、服务需求、目标用户、并发人数）
- ⏰ 咨询时间
- 🚨 优先处理提醒

## 🧪 测试方法

1. **提交测试表单**: 访问 `/contact` 页面提交表单
2. **查看控制台日志**: 检查推送结果
3. **验证飞书消息**: 确认飞书群收到消息
4. **验证钉钉消息**: 确认钉钉群收到消息

## 📊 监控和日志

### 成功日志
```
📤 推送结果: {
  dingTalk: '✅ 成功',
  feishu: '✅ 成功'
}
```

### 失败日志
```
⚠️ 钉钉和飞书消息发送都失败，但仍返回成功给用户: {
  dingTalk: '错误信息',
  feishu: '错误信息'
}
```

## 🔒 安全说明

- **签名验证**: 飞书机器人使用HMAC-SHA256签名验证
- **时间戳**: 每次请求都包含时间戳，防止重放攻击
- **环境变量**: 敏感配置通过环境变量管理

## 🚀 部署说明

### 本地开发
- 配置已硬编码，可直接使用
- 建议创建 `.env.local` 文件管理配置

### 生产环境
- 通过环境变量配置机器人信息
- 确保网络能访问飞书和钉钉API

## 📞 技术支持

如果遇到问题，请检查：
1. 网络连接是否正常
2. 飞书机器人Webhook是否有效
3. 签名密钥是否正确
4. 控制台错误日志

---

**🎉 恭喜！您的网站现在具备了双重推送能力，确保销售线索不会遗漏！**
